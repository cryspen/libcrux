module Spec.MLDSA.Ntt
open Core

assume val mont_mul: i32 -> i32 -> i32

let ntt_step zeta (a, b) =
    let t = mont_mul b zeta in
    (add_mod a t, sub_mod a t)

let zeta_r (i: nat {i < 256}): n:int{range n I32} =
  match i with
  |   0 ->        0 |   1 ->    25847 |   2 -> -2608894 |   3 ->  -518909 |   4 ->   237124 |   5 ->  -777960 |   6 ->  -876248 |   7 ->   466468
  |   8 ->  1826347 |   9 ->  2353451 |  10 ->  -359251 |  11 -> -2091905 |  12 ->  3119733 |  13 -> -2884855 |  14 ->  3111497 |  15 ->  2680103
  |  16 ->  2725464 |  17 ->  1024112 |  18 -> -1079900 |  19 ->  3585928 |  20 ->  -549488 |  21 -> -1119584 |  22 ->  2619752 |  23 -> -2108549
  |  24 -> -2118186 |  25 -> -3859737 |  26 -> -1399561 |  27 -> -3277672 |  28 ->  1757237 |  29 ->   -19422 |  30 ->  4010497 |  31 ->   280005
  |  32 ->  2706023 |  33 ->    95776 |  34 ->  3077325 |  35 ->  3530437 |  36 -> -1661693 |  37 -> -3592148 |  38 -> -2537516 |  39 ->  3915439
  |  40 -> -3861115 |  41 -> -3043716 |  42 ->  3574422 |  43 -> -2867647 |  44 ->  3539968 |  45 ->  -300467 |  46 ->  2348700 |  47 ->  -539299
  |  48 -> -1699267 |  49 -> -1643818 |  50 ->  3505694 |  51 -> -3821735 |  52 ->  3507263 |  53 -> -2140649 |  54 -> -1600420 |  55 ->  3699596
  |  56 ->   811944 |  57 ->   531354 |  58 ->   954230 |  59 ->  3881043 |  60 ->  3900724 |  61 -> -2556880 |  62 ->  2071892 |  63 -> -2797779
  |  64 -> -3930395 |  65 -> -1528703 |  66 -> -3677745 |  67 -> -3041255 |  68 -> -1452451 |  69 ->  3475950 |  70 ->  2176455 |  71 -> -1585221
  |  72 -> -1257611 |  73 ->  1939314 |  74 -> -4083598 |  75 -> -1000202 |  76 -> -3190144 |  77 -> -3157330 |  78 -> -3632928 |  79 ->   126922
  |  80 ->  3412210 |  81 ->  -983419 |  82 ->  2147896 |  83 ->  2715295 |  84 -> -2967645 |  85 -> -3693493 |  86 ->  -411027 |  87 -> -2477047
  |  88 ->  -671102 |  89 -> -1228525 |  90 ->   -22981 |  91 -> -1308169 |  92 ->  -381987 |  93 ->  1349076 |  94 ->  1852771 |  95 -> -1430430
  |  96 -> -3343383 |  97 ->   264944 |  98 ->   508951 |  99 ->  3097992 | 100 ->    44288 | 101 -> -1100098 | 102 ->   904516 | 103 ->  3958618
  | 104 -> -3724342 | 105 ->    -8578 | 106 ->  1653064 | 107 -> -3249728 | 108 ->  2389356 | 109 ->  -210977 | 110 ->   759969 | 111 -> -1316856
  | 112 ->   189548 | 113 -> -3553272 | 114 ->  3159746 | 115 -> -1851402 | 116 -> -2409325 | 117 ->  -177440 | 118 ->  1315589 | 119 ->  1341330
  | 120 ->  1285669 | 121 -> -1584928 | 122 ->  -812732 | 123 -> -1439742 | 124 -> -3019102 | 125 -> -3881060 | 126 -> -3628969 | 127 ->  3839961
  | 128 ->  2091667 | 129 ->  3407706 | 130 ->  2316500 | 131 ->  3817976 | 132 -> -3342478 | 133 ->  2244091 | 134 -> -2446433 | 135 -> -3562462
  | 136 ->   266997 | 137 ->  2434439 | 138 -> -1235728 | 139 ->  3513181 | 140 -> -3520352 | 141 -> -3759364 | 142 -> -1197226 | 143 -> -3193378
  | 144 ->   900702 | 145 ->  1859098 | 146 ->   909542 | 147 ->   819034 | 148 ->   495491 | 149 -> -1613174 | 150 ->   -43260 | 151 ->  -522500
  | 152 ->  -655327 | 153 -> -3122442 | 154 ->  2031748 | 155 ->  3207046 | 156 -> -3556995 | 157 ->  -525098 | 158 ->  -768622 | 159 -> -3595838
  | 160 ->   342297 | 161 ->   286988 | 162 -> -2437823 | 163 ->  4108315 | 164 ->  3437287 | 165 -> -3342277 | 166 ->  1735879 | 167 ->   203044
  | 168 ->  2842341 | 169 ->  2691481 | 170 -> -2590150 | 171 ->  1265009 | 172 ->  4055324 | 173 ->  1247620 | 174 ->  2486353 | 175 ->  1595974
  | 176 -> -3767016 | 177 ->  1250494 | 178 ->  2635921 | 179 -> -3548272 | 180 -> -2994039 | 181 ->  1869119 | 182 ->  1903435 | 183 -> -1050970
  | 184 -> -1333058 | 185 ->  1237275 | 186 -> -3318210 | 187 -> -1430225 | 188 ->  -451100 | 189 ->  1312455 | 190 ->  3306115 | 191 -> -1962642
  | 192 -> -1279661 | 193 ->  1917081 | 194 -> -2546312 | 195 -> -1374803 | 196 ->  1500165 | 197 ->   777191 | 198 ->  2235880 | 199 ->  3406031
  | 200 ->  -542412 | 201 -> -2831860 | 202 -> -1671176 | 203 -> -1846953 | 204 -> -2584293 | 205 -> -3724270 | 206 ->   594136 | 207 -> -3776993
  | 208 -> -2013608 | 209 ->  2432395 | 210 ->  2454455 | 211 ->  -164721 | 212 ->  1957272 | 213 ->  3369112 | 214 ->   185531 | 215 -> -1207385
  | 216 -> -3183426 | 217 ->   162844 | 218 ->  1616392 | 219 ->  3014001 | 220 ->   810149 | 221 ->  1652634 | 222 -> -3694233 | 223 -> -1799107
  | 224 -> -3038916 | 225 ->  3523897 | 226 ->  3866901 | 227 ->   269760 | 228 ->  2213111 | 229 ->  -975884 | 230 ->  1717735 | 231 ->   472078
  | 232 ->  -426683 | 233 ->  1723600 | 234 -> -1803090 | 235 ->  1910376 | 236 -> -1667432 | 237 -> -1104333 | 238 ->  -260646 | 239 -> -3833893
  | 240 -> -2939036 | 241 -> -2235985 | 242 ->  -420899 | 243 -> -2286327 | 244 ->   183443 | 245 ->  -976891 | 246 ->  1612842 | 247 -> -3545687
  | 248 ->  -554416 | 249 ->  3919660 | 250 ->   -48306 | 251 -> -1362209 | 252 ->  3937738 | 253 ->  1400424 | 254 ->  -846154 | 255 ->  1976782

